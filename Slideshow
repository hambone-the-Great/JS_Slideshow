
class Slideshow 
{       
    #container = null
    #children = null; 
    #startingSlide = 0; 
    #fadeDuration = 35;
    #slidePauseDuration = 5000;

    get Container(){
        return this.#container;
    } 

    set Container(v){
        this.#container = v; 
    }

    get Children() {
        return this.#children; 
    }

    set Children(v){
        this.#children = v; 
    }

    get StartingSlide(){
        return this.#startingSlide;
    }

    set StartingSlide(v) {
        this.#startingSlide = ((v > -1) && (v < this.#children.length)) ? v : 0;
    }

    get FadeDuration() {
        return this.#fadeDuration; 
    }

    set FadeDuration(v){
        this.#fadeDuration = v;
    }

    get SlidePauseDuration(){
        return this.#slidePauseDuration;
    }

    set SlidePauseDuration(v){
        this.#slidePauseDuration = v; 
    }

   
    constructor(id){
        let el = document.getElementById(id); 
        if (!el) {
            console.log("Provided ID doesn't exist.");
            console.log("Creating div");
            el = document.createElement("div"); 
            el.id = id;             
        }
        
        this.#container = el; 
        this.#children = el.children; 
    }

    /**
     * 
     * @param {Slide} slide 
     */
    AddSlide(slide){        
        this.Container.appendChild(slide.Container); 
        slide.Container.style.backgroundImage = "url(" + slide.ImageUrl + ");";
    }
    
    Start(){        
        this.FadeIn(this, 0, this.#startingSlide, this.#children, this.#slidePauseDuration);
    }

    FadeIn(slideshow, i, j, slides, pauseDuration){
                
        var opacity = i / 100; 
        var slide = slides[j];
        var duration = slideshow.#fadeDuration;

        if (i >= 100){           
            
            window.setTimeout(function(){
                slideshow.FadeOut(slideshow, i, j, slides, pauseDuration);                            
                return;        
            }, pauseDuration);
            return ;
        }
        
        slide.classList.add("show");
        slide.style.opacity = opacity;
        
        window.setTimeout(function(){
            
            i++;
            slideshow.FadeIn(slideshow, i, j, slides, pauseDuration); 

        }, duration);


    }
    
    FadeOut(slideshow, i, j, slides, pauseDuration){
                
        var opacity = i / 100; 
        var slide = slides[j];
        var duration = slideshow.#fadeDuration;

        if (i <= 0) 
        {        
            slide.classList.remove("show");            
            j++;
            j = slides.length > j ? j : 0; 
            slideshow.FadeIn(slideshow, i, j, slides, pauseDuration);  
            return;                   
        }
        
        slide.style.opacity = opacity;
        
        window.setTimeout(function(){                
            i--;
            slideshow.FadeOut(slideshow, i, j, slides, pauseDuration); 
        }, duration);
    }
}

class Slide {

    #container = null;
    #imageUrl = ""; 
    #textContent = "";
    #cssClass = "";    

    get Container() { return this.#container; }
    set Container(v) { this.#container = v; }
    get ImageUrl() { return this.#imageUrl; }
    set ImageUrl(v) { this.#imageUrl = v; }
    get TextContent() { return this.#textContent; }
    set TextContent(v) { this.#textContent = v; }
    get CssClass() { return this.#cssClass; }
    set CssClass(v) { this.#cssClass = v; }

    constructor(url, content, css) {        
        
        let slide = document.createElement("div"); 

        if (content) {
            this.#textContent = content; 
            let span = document.createElement("span"); 
            span.innerHTML = content; 
            slide.appendChild(span); 
        }  
                 
        if (css) {
            this.#cssClass = css; 
            slide.classList.add(css); 
        }     
        
        if (url) { 
            this.ImageUrl = url;                         
            slide.style.backgroundImage = 'url(' + url + ');'; 
            console.log(slide); 
            console.log(slide.style);             
        }

        this.#container = slide; 
        
    }


    
}
